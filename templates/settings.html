<!-- wp:html -->
<form method="post" action="http://home/wordpress/wp-admin/admin-post.php">
<input type="hidden" name="action" value="settings_action_hook">
<input type="hidden" name="custom_nonce" value="123">

<div>What email(s) would you like to be notified if you are not responsive?</div>
<input type="text" name="imok_contact_email_1" id="imok_contact_email_1" value="" placeholder="Email contact #1">
<br>
<input type="text" name="imok_contact_email_2" id="imok_contact_email_2" placeholder="Email contact #2">
<br>
<input type="text" name="imok_contact_email_3" id="imok_contact_email_3" placeholder="Email contact #3">

<p>

</p><div>What email message would you like to send if you are not responsive? (Edit the suggested one to suit)</div>
<textarea id="imok_email_form" name="imok_email_form" rows="4" cols="40">Vince has not reported in to the IMOK website by the chosen Alert time.
You may want to check on them.
Their phone number is xxx-xxx-xxxx
Their email address is xxxxxx@gmail.com</textarea>

<p>

</p><div>On what date &amp; time should your first alert be sent if you are not responsive?</div>
<label for="imok_start_date">Date:</label> <input type="date" name="imok_start_date" id="imok_start_date">
<label for="imok_start_time">Time:</label> <input type="time" id="imok_start_time" name="imok_start_time">

<p>

<input type="hidden" id="imok_timeout_temp" value="1">
<label for="timeout">How many days after you push the IMOK button would you like to set your next alert date?</label>
<select name="imok_timeout" id="imok_timeout" value="1">
  <option value=".5">.5</option>
  <option value="1" selected="">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
  <option value="4">4</option>
  <option value="5">5</option>
  <option value="6">6</option>
  <option value="7">7</option>
</select>

</p><p>

<input type="hidden" id="pre_warn_time_temp" value="1">
<label for="timeout">A reminder email will be sent to your email address before the alert is sent. How many hours before the alert should this email be sent?</label>
<select name="pre_warn_time" id="pre_warn_time" value="1">
  <option value=".5">.5</option>
  <option value="1" selected="">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
  <option value="4">4</option>
  <option value="5">5</option>
  <option value="6">6</option>
  <option value="7">7</option>
</select>

</p><p>

<input type="submit" name="submit" id="submit" value="Save Settings">
</p></form>

<script>document.getElementById('imok_contact_email_1').value = '[imok_contact_email_1]';</script>
<script>document.getElementById('imok_contact_email_2').value = '[imok_contact_email_2]';</script>
<script>document.getElementById('imok_contact_email_3').value = '[imok_contact_email_3]';</script>
<script>document.getElementById('imok_start_date').value = '[imok_start_date]';</script>
<script>document.getElementById('imok_email_form').innerHTML = `[imok_email_form]`;</script>
<script>document.getElementById('imok_start_time').value = "[imok_start_time]";</script>
<script>document.getElementById("imok_timeout").value = "[imok_timeout]";</script>
<!-- /wp:html -->

<!-- wp:html -->
<script>

function calc_date()
	{
		//convert yyyy-mm-dd and hh:mm to epoch time to send to server
	const date1 = new Date();
	var tz_offset_hours = date1.getTimezoneOffset() / 60 ;
	document.getElementById("tz_offset_hours").value = -tz_offset_hours;

	var start_date = document.getElementById("imok_start_date").value; //gives us yyyy-mm-dd
	var date_ip = start_date.split('-');
	var year = date_ip[0];
	var month = parseInt(date_ip[1]) - 1; //months start at 0 in Date.UTC
	var day = date_ip[2];
	var start_time = document.getElementById("imok_start_time").value;//gives us hh:mm
	var time_ip = start_time.split(':');
	var hour = time_ip[0];
	var minute = time_ip[1];

	var date_trigger = new Date(year, month , day , hour , minute);
	var start_UTC = Math.floor( date_trigger.getTime() / 1000 );
	if(date_trigger.getTime() < date1.getTime()){//do not allow trigger time in the past
		//alert("Trying to set a trigger time in the past. Please choose a time in the future.");
		//return 0;
		}

		if( start_date == '' || start_time == '' || document.getElementById("imok_contact_email_1").value == '' ){
				alert("You must set 'Alert Start Date', 'Alert Start Time', and at least 'Email Contact 1'.");
				return false;
		}

	document.getElementById("timestamp").value = start_UTC; //set time stamp value to send to server
	return true;
	}



//set drop down values
//document.getElementById("imok_timeout").value = "[imok_timeout]";
//document.getElementById("imok_timeout_temp").value;
//document.getElementById("pre_warn_time").value  = //document.getElementById("pre_warn_time_temp").value;

</script>
<!-- /wp:html -->
